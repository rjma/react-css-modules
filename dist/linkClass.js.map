{"version":3,"sources":["linkClass.js"],"names":[],"mappings":";;;;;;;;;;;;;;AACA;;;;AAGA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAM,cAAc,SAAd,WAAc,CAAC,OAAD,EAAwB,MAAxB,EAAwC,aAAxC,EAAgF;AAChG,QAAI,wBAAJ;QACI,wBADJ;QAEI,2BAFJ;;AAIA,yBAAqB,OAArB;;AAEA,QAAI,OAAO,QAAP,IAAmB,OAAO,QAAP,CAAgB,kBAAhB,CAAvB,EAA4D;AACxD,0BAAkB,IAAlB;;;AAGA,6BAAqB,8BAAe,kBAAf,CAArB;AACA,2BAAmB,KAAnB,GAA2B,8BAAe,mBAAmB,KAAlC,CAA3B;AACH;;AAED,QAAM,aAAa,8BAAe,mBAAmB,KAAnB,CAAyB,SAAzB,IAAsC,EAArD,EAAyD,cAAc,aAAvE,CAAnB;;AAEA,QAAI,gBAAM,cAAN,CAAqB,mBAAmB,KAAnB,CAAyB,QAA9C,CAAJ,EAA6D;AACzD,2BAAmB,KAAnB,CAAyB,QAAzB,GAAoC,YAAY,gBAAM,QAAN,CAAe,IAAf,CAAoB,mBAAmB,KAAnB,CAAyB,QAA7C,CAAZ,EAAoE,MAApE,EAA4E,aAA5E,CAApC;AACH,KAFD,MAEO,IAAI,uBAAU,mBAAmB,KAAnB,CAAyB,QAAnC,KAAgD,0BAAW,mBAAmB,KAAnB,CAAyB,QAApC,CAApD,EAAmG;AACtG,2BAAmB,KAAnB,CAAyB,QAAzB,GAAoC,gBAAM,QAAN,CAAe,GAAf,CAAmB,mBAAmB,KAAnB,CAAyB,QAA5C,EAAsD,UAAC,IAAD,EAAU;AAChG,gBAAI,gBAAM,cAAN,CAAqB,IAArB,CAAJ,EAAgC;AAC5B,uBAAO,YAAY,IAAZ,EAAkB,MAAlB,EAA0B,aAA1B,CAAP;AACH,aAFD,MAEO;AACH,uBAAO,IAAP;AACH;AACJ,SANmC,CAApC;AAOH;;AAED,QAAI,WAAW,MAAf,EAAuB;AACnB,0BAAkB,uCAAwB,MAAxB,EAAgC,UAAhC,EAA4C,cAAc,iBAA1D,CAAlB;;AAEA,YAAI,eAAJ,EAAqB;AACjB,gBAAI,mBAAmB,KAAnB,CAAyB,SAA7B,EAAwC;AACpC,kCAAkB,mBAAmB,KAAnB,CAAyB,SAAzB,GAAqC,GAArC,GAA2C,eAA7D;AACH;;AAED,+BAAmB,KAAnB,CAAyB,SAAzB,GAAqC,eAArC;AACA,+BAAmB,KAAnB,CAAyB,SAAzB,GAAqC,IAArC;AACH;AACJ;;AAED,QAAI,eAAJ,EAAqB;AACjB,eAAO,MAAP,CAAc,mBAAmB,KAAjC;AACA,eAAO,MAAP,CAAc,kBAAd;AACH;;AAED,WAAO,kBAAP;AACH,CAhDD;;;;;;;;kBAuDe,UAAC,OAAD,EAAyE;AAAA,QAAjD,MAAiD,yDAAxC,EAAwC;AAAA,QAApC,iBAAoC;;;AAEpF,QAAI,CAAC,wBAAW,OAAX,CAAL,EAA0B;AACtB,eAAO,OAAP;AACH;;AAED,QAAM,gBAAgB,iCAAkB,iBAAlB,CAAtB;;AAEA,WAAO,YAAY,OAAZ,EAAqB,MAArB,EAA6B,aAA7B,CAAP;AACH,C","file":"linkClass.js","sourcesContent":["import _ from 'lodash';\nimport React, {\n    ReactElement\n} from 'react';\nimport makeConfiguration from './makeConfiguration';\nimport isIterable from './isIterable';\nimport parseStyleName from './parseStyleName';\nimport generateAppendClassName from './generateAppendClassName';\nimport objectUnfreeze from 'object-unfreeze';\n\nconst linkElement = (element: ReactElement, styles: Object, configuration: Object): ReactElement => {\n    let appendClassName,\n        elementIsFrozen,\n        elementShallowCopy;\n\n    elementShallowCopy = element;\n\n    if (Object.isFrozen && Object.isFrozen(elementShallowCopy)) {\n        elementIsFrozen = true;\n\n        // https://github.com/facebook/react/blob/v0.13.3/src/classic/element/ReactElement.js#L131\n        elementShallowCopy = objectUnfreeze(elementShallowCopy);\n        elementShallowCopy.props = objectUnfreeze(elementShallowCopy.props);\n    }\n\n    const styleNames = parseStyleName(elementShallowCopy.props.styleName || '', configuration.allowMultiple);\n\n    if (React.isValidElement(elementShallowCopy.props.children)) {\n        elementShallowCopy.props.children = linkElement(React.Children.only(elementShallowCopy.props.children), styles, configuration);\n    } else if (_.isArray(elementShallowCopy.props.children) || isIterable(elementShallowCopy.props.children)) {\n        elementShallowCopy.props.children = React.Children.map(elementShallowCopy.props.children, (node) => {\n            if (React.isValidElement(node)) {\n                return linkElement(node, styles, configuration);\n            } else {\n                return node;\n            }\n        });\n    }\n\n    if (styleNames.length) {\n        appendClassName = generateAppendClassName(styles, styleNames, configuration.errorWhenNotFound);\n\n        if (appendClassName) {\n            if (elementShallowCopy.props.className) {\n                appendClassName = elementShallowCopy.props.className + ' ' + appendClassName;\n            }\n\n            elementShallowCopy.props.className = appendClassName;\n            elementShallowCopy.props.styleName = null;\n        }\n    }\n\n    if (elementIsFrozen) {\n        Object.freeze(elementShallowCopy.props);\n        Object.freeze(elementShallowCopy);\n    }\n\n    return elementShallowCopy;\n};\n\n/**\n * @param {ReactElement} element\n * @param {Object} styles CSS modules class map.\n * @param {CSSModules~Options} userConfiguration\n */\nexport default (element: ReactElement, styles = {}, userConfiguration): ReactElement => {\n    // @see https://github.com/gajus/react-css-modules/pull/30\n    if (!_.isObject(element)) {\n        return element;\n    }\n\n    const configuration = makeConfiguration(userConfiguration);\n\n    return linkElement(element, styles, configuration);\n};\n"]}